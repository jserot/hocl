\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{grammar-defns}

\RequirePackage{suffix}
\RequirePackage{longtable}
\RequirePackage{tabu}

\newenvironment{grammar}{
  \begin{trivlist}
    \item[]
      \begin{longtabu}{r@{}c@{}X@{}}
}{
      \end{longtabu}
  \end{trivlist}
}

\newcommand\gramsp{\quad}
\newcommand\gramdef{$\gramsp::=\gramsp$}
\newcommand\grambar{$\gramsp|\gramsp$}
\newcommand\grameps{\ensuremath{\epsilon}}
\newcommand\gramnonterm[1]{\ensuremath{\langle\textnormal{#1}\rangle}}
\newcommand\gramfunc[1]{\gramnonterm{#1}}
\newcommand\gramterm[1]{#1}

\newcommand\ACTOR{\textbf{actor}}
\newcommand\AND{\textbf{and}}
\newcommand\ARROW{\ensuremath{\mathbf{\rightarrow}}}
\newcommand\BAR{\ensuremath{\mathbf{|}}}
\newcommand\COLON{\textbf{:}}
\newcommand\COLONCOLON{\textbf{::}}
\newcommand\COMMA{\textbf{,}}
\newcommand\ELSE{\textbf{else}}
\newcommand\zzzEND{\textbf{end}}
\newcommand\EOF{}
\newcommand\EQUAL{\textbf{=}}
\newcommand\FALSE{\textbf{false}}
\newcommand\FUN{\textbf{fun}}
\newcommand\GRAPH{\textbf{graph}}
\newcommand\GREATER{\ensuremath{\mathbf{>}}}
\newcommand\IDENT{\gramnonterm{ident}}
\newcommand\IF{\textbf{if}}
\newcommand\IN{\textbf{in}}
\newcommand\INFIX{\gramnonterm{infix0}}
\newcommand\INFIXII{\gramnonterm{infix2}}
\newcommand\INFIXIII{\gramnonterm{infix3}}
\newcommand\INT{\gramnonterm{int}}
\newcommand\LBRACE{\textbf{\{}}
\newcommand\LBRACKET{\textbf{[}}
\newcommand\LESS{\ensuremath{\mathbf{<}}}
\newcommand\LET{\textbf{let}}
\newcommand\LPAREN{\textbf{(}}
\newcommand\MATCH{\textbf{match}}
\newcommand\NODE{\textbf{node}}
\newcommand\NOTEQUAL{\ensuremath{\mathbf{\not =}}}
\newcommand\OTHER{\textbf{other}}
\newcommand\OUT{\textbf{out}}
\newcommand\PARAM{\textbf{param}}
\newcommand\RATE{\textbf{rate}}
\newcommand\RBRACE{\textbf{\}}}
\newcommand\RBRACKET{\textbf{]}}
\newcommand\REC{\textbf{rec}}
\newcommand\RPAREN{\textbf{)}}
\newcommand\SEMI{\textbf{;}}
\newcommand\STAR{\ensuremath{\mathbf{*}}}
\newcommand\STRING{\textbf{string}}
\newcommand\STRUCT{\textbf{struct}}
\newcommand\THEN{\textbf{then}}
\newcommand\TRUE{\textbf{true}}
\newcommand\TYPE{\textbf{type}}
\newcommand\TYBOOL{\textbf{bool}}
\newcommand\TYINT{\textbf{int}}
\newcommand\TYUNIT{\textbf{unit}}
\newcommand\UNDERSCORE{\textbf{\_}}
\newcommand\VAL{\textbf{val}}
\newcommand\WIRE{\textbf{wire}}
\newcommand\WITH{\textbf{with}}

\newcommand\actordesc{actor\_desc}
\newcommand\constparamvalue{const\_param\_value}
\newcommand\coreexpr{core\_expr}
\newcommand\decl{decl}
\newcommand\fungraphdesc{fun\_graph\_desc}
\newcommand\gnodedefn{gnode\_defn}
\newcommand\gnodeio{gnode\_io}
\newcommand\gnodeios{gnode\_ios}
\newcommand\gnodeparams{gnode\_params}
\newcommand\graphdecl{graph\_decl}
\newcommand\graphdefn{graph\_defn}
\newcommand\graphparamvalue{graph\_param\_value}
\newcommand\graphparams{graph\_params}
\newcommand\gwiredefn{gwire\_defn}
\newcommand\implattr{impl\_attr}
\newcommand\ioannot{io\_annot}
\newcommand\iodecl{io\_decl}
\newcommand\iodecls{io\_decls}
\newcommand\mylist{my\_list}
\newcommand\mynonemptylist{my\_nonempty\_list}
\newcommand\myseparatedlist{my\_separated\_list}
\newcommand\myseparatednonemptylist{my\_separated\_nonempty\_list}
\newcommand\netbinding{net\_binding}
\newcommand\netbindingname{net\_binding\_name}
\newcommand\netcase{net\_case}
\newcommand\netdefn{net\_defn}
\newcommand\netexpr{net\_expr}
\newcommand\netexprcommalist{net\_expr\_comma\_list}
\newcommand\netpattern{net\_pattern}
\newcommand\netpatterncommalist{net\_pattern\_comma\_list}
\newcommand\nodedecl{node\_decl}
\newcommand\nodeimpl{node\_impl}
\newcommand\nodeintf{node\_intf}
\newcommand\nodekind{node\_kind}
\newcommand\nodeparamdecl{node\_param\_decl}
\newcommand\nodeparams{node\_params}
\newcommand\optgnodeparams{opt\_gnode\_params}
\newcommand\optgraphparams{opt\_graph\_params}
\newcommand\optioannots{opt\_io\_annots}
\newcommand\optnodeparams{opt\_node\_params}
\newcommand\optional{optional}
\newcommand\program{program}
\newcommand\simplecoreexpr{simple\_core\_expr}
\newcommand\simplenetexpr{simple\_net\_expr}
\newcommand\simplenetpattern{simple\_net\_pattern}
\newcommand\simpletypeexpr{simple\_type\_expr}
\newcommand\structdefn{struct\_defn}
\newcommand\structgraphdesc{struct\_graph\_desc}
\newcommand\typedecl{type\_decl}
\newcommand\valuedecl{value\_decl}
\WithSuffix\newcommand\ACTOR*{\gramterm{\ACTOR}}
\WithSuffix\newcommand\AND*{\gramterm{\AND}}
\WithSuffix\newcommand\ARROW*{\gramterm{\ARROW}}
\WithSuffix\newcommand\BAR*{\gramterm{\BAR}}
\WithSuffix\newcommand\COLON*{\gramterm{\COLON}}
\WithSuffix\newcommand\COLONCOLON*{\gramterm{\COLONCOLON}}
\WithSuffix\newcommand\COMMA*{\gramterm{\COMMA}}
\WithSuffix\newcommand\ELSE*{\gramterm{\ELSE}}
\WithSuffix\newcommand\zzzEND*{\gramterm{\zzzEND}}
\WithSuffix\newcommand\EOF*{\gramterm{\EOF}}
\WithSuffix\newcommand\EQUAL*{\gramterm{\EQUAL}}
\WithSuffix\newcommand\FALSE*{\gramterm{\FALSE}}
\WithSuffix\newcommand\FUN*{\gramterm{\FUN}}
\WithSuffix\newcommand\GRAPH*{\gramterm{\GRAPH}}
\WithSuffix\newcommand\GREATER*{\gramterm{\GREATER}}
\WithSuffix\newcommand\IDENT*{\gramterm{\IDENT}}
\WithSuffix\newcommand\IF*{\gramterm{\IF}}
\WithSuffix\newcommand\IN*{\gramterm{\IN}}
\WithSuffix\newcommand\INFIX*{\gramterm{\INFIX}}
\WithSuffix\newcommand\INFIXII*{\gramterm{\INFIXII}}
\WithSuffix\newcommand\INFIXIII*{\gramterm{\INFIXIII}}
\WithSuffix\newcommand\INT*{\gramterm{\INT}}
\WithSuffix\newcommand\LBRACE*{\gramterm{\LBRACE}}
\WithSuffix\newcommand\LBRACKET*{\gramterm{\LBRACKET}}
\WithSuffix\newcommand\LESS*{\gramterm{\LESS}}
\WithSuffix\newcommand\LET*{\gramterm{\LET}}
\WithSuffix\newcommand\LPAREN*{\gramterm{\LPAREN}}
\WithSuffix\newcommand\MATCH*{\gramterm{\MATCH}}
\WithSuffix\newcommand\NODE*{\gramterm{\NODE}}
\WithSuffix\newcommand\NOTEQUAL*{\gramterm{\NOTEQUAL}}
\WithSuffix\newcommand\OTHER*{\gramterm{\OTHER}}
\WithSuffix\newcommand\OUT*{\gramterm{\OUT}}
\WithSuffix\newcommand\PARAM*{\gramterm{\PARAM}}
\WithSuffix\newcommand\RATE*{\gramterm{\RATE}}
\WithSuffix\newcommand\RBRACE*{\gramterm{\RBRACE}}
\WithSuffix\newcommand\RBRACKET*{\gramterm{\RBRACKET}}
\WithSuffix\newcommand\REC*{\gramterm{\REC}}
\WithSuffix\newcommand\RPAREN*{\gramterm{\RPAREN}}
\WithSuffix\newcommand\SEMI*{\gramterm{\SEMI}}
\WithSuffix\newcommand\STAR*{\gramterm{\STAR}}
\WithSuffix\newcommand\STRING*{\gramterm{\STRING}}
\WithSuffix\newcommand\STRUCT*{\gramterm{\STRUCT}}
\WithSuffix\newcommand\THEN*{\gramterm{\THEN}}
\WithSuffix\newcommand\TRUE*{\gramterm{\TRUE}}
\WithSuffix\newcommand\TYPE*{\gramterm{\TYPE}}
\WithSuffix\newcommand\TYBOOL*{\gramterm{\TYBOOL}}
\WithSuffix\newcommand\TYINT*{\gramterm{\TYINT}}
\WithSuffix\newcommand\TYUNIT*{\gramterm{\TYUNIT}}
\WithSuffix\newcommand\UNDERSCORE*{\gramterm{\UNDERSCORE}}
\WithSuffix\newcommand\VAL*{\gramterm{\VAL}}
\WithSuffix\newcommand\WIRE*{\gramterm{\WIRE}}
\WithSuffix\newcommand\WITH*{\gramterm{\WITH}}
\WithSuffix\newcommand\actordesc*{\gramnonterm{\actordesc}}
\WithSuffix\newcommand\constparamvalue*{\gramnonterm{\constparamvalue}}
\WithSuffix\newcommand\coreexpr*{\gramnonterm{\coreexpr}}
\WithSuffix\newcommand\decl*{\gramnonterm{\decl}}
\WithSuffix\newcommand\fungraphdesc*{\gramnonterm{\fungraphdesc}}
\WithSuffix\newcommand\gnodedefn*{\gramnonterm{\gnodedefn}}
\WithSuffix\newcommand\gnodeio*{\gramnonterm{\gnodeio}}
\WithSuffix\newcommand\gnodeios*{\gramnonterm{\gnodeios}}
\WithSuffix\newcommand\gnodeparams*{\gramnonterm{\gnodeparams}}
\WithSuffix\newcommand\graphdecl*{\gramnonterm{\graphdecl}}
\WithSuffix\newcommand\graphdefn*{\gramnonterm{\graphdefn}}
\WithSuffix\newcommand\graphparamvalue*{\gramnonterm{\graphparamvalue}}
\WithSuffix\newcommand\graphparams*{\gramnonterm{\graphparams}}
\WithSuffix\newcommand\gwiredefn*{\gramnonterm{\gwiredefn}}
\WithSuffix\newcommand\implattr*{\gramnonterm{\implattr}}
\WithSuffix\newcommand\ioannot*{\gramnonterm{\ioannot}}
\WithSuffix\newcommand\iodecl*{\gramnonterm{\iodecl}}
\WithSuffix\newcommand\iodecls*{\gramnonterm{\iodecls}}
\WithSuffix\newcommand\netbinding*{\gramnonterm{\netbinding}}
\WithSuffix\newcommand\netbindingname*{\gramnonterm{\netbindingname}}
\WithSuffix\newcommand\netcase*{\gramnonterm{\netcase}}
\WithSuffix\newcommand\netdefn*{\gramnonterm{\netdefn}}
\WithSuffix\newcommand\netexpr*{\gramnonterm{\netexpr}}
\WithSuffix\newcommand\netexprcommalist*{\gramnonterm{\netexprcommalist}}
\WithSuffix\newcommand\netpattern*{\gramnonterm{\netpattern}}
\WithSuffix\newcommand\netpatterncommalist*{\gramnonterm{\netpatterncommalist}}
\WithSuffix\newcommand\nodedecl*{\gramnonterm{\nodedecl}}
\WithSuffix\newcommand\nodeimpl*{\gramnonterm{\nodeimpl}}
\WithSuffix\newcommand\nodeintf*{\gramnonterm{\nodeintf}}
\WithSuffix\newcommand\nodekind*{\gramnonterm{\nodekind}}
\WithSuffix\newcommand\nodeparams*{\gramnonterm{\nodeparams}}
\WithSuffix\newcommand\nodeparamdecl*{\gramnonterm{\nodeparamdecl}}
\WithSuffix\newcommand\optgnodeparams*{\gramnonterm{\optgnodeparams}}
\WithSuffix\newcommand\optgraphparams*{\gramnonterm{\optgraphparams}}
\WithSuffix\newcommand\optioannots*{\gramnonterm{\optioannots}}
\WithSuffix\newcommand\optnodeparams*{\gramnonterm{\optnodeparams}}
\WithSuffix\newcommand\program*{\gramnonterm{\program}}
\WithSuffix\newcommand\simplecoreexpr*{\gramnonterm{\simplecoreexpr}}
\WithSuffix\newcommand\simplenetexpr*{\gramnonterm{\simplenetexpr}}
\WithSuffix\newcommand\simplenetpattern*{\gramnonterm{\simplenetpattern}}
\WithSuffix\newcommand\simpletypeexpr*{\gramnonterm{\simpletypeexpr}}
\WithSuffix\newcommand\structdefn*{\gramnonterm{\structdefn}}
\WithSuffix\newcommand\structgraphdesc*{\gramnonterm{\structgraphdesc}}
\WithSuffix\newcommand\typedecl*{\gramnonterm{\typedecl}}
\WithSuffix\newcommand\valuedecl*{\gramnonterm{\valuedecl}}
\WithSuffix\newcommand\mylist*{\gramfunc{\mylist}}
\WithSuffix\newcommand\mynonemptylist*{\gramfunc{\mynonemptylist}}
\WithSuffix\newcommand\myseparatedlist*{\gramfunc{\myseparatedlist}}
\WithSuffix\newcommand\myseparatednonemptylist*{\gramfunc{\myseparatednonemptylist}}
\WithSuffix\newcommand\optional*{\gramfunc{\optional}}

\newcommand\gramopt[1]{[#1]}
\newcommand\gramplus[1]{\textnormal{#1}\ensuremath{^+}}
\newcommand\gramstar[1]{\textnormal{#1}\ensuremath{^*}}
\newcommand\gramseplist[2]{\textnormal{#2}\ensuremath{_{\textnormal{#1}}^*}}
\newcommand\gramsepnelist[2]{\textnormal{#2}\ensuremath{_{\textnormal{#1}}^+}}
\newcommand\paren[1]{\ensuremath{\left(\textnormal{#1}\right)}}
\WithSuffix\newcommand\gramopt*[1]{\gramopt{#1}}
\WithSuffix\newcommand\gramplus*[1]{\gramplus{\paren{#1}}}
\WithSuffix\newcommand\gramstar*[1]{\gramstar{\paren{#1}}}
\WithSuffix\newcommand\gramseplist*[2]{\gramseplist{#1}{\paren{#2}}}
\WithSuffix\newcommand\gramsepnelist*[2]{\gramsepnelist{#1}{\paren{#2}}}
