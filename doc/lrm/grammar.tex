\begin{grammar}
\gramfunc{\program{}}& \gramdef & \gramstar{\decl*{}} \EOF*{}
  \\& & \\

\gramfunc{\decl{}}& \gramdef & \typedecl*{} \SEMI*{}\\
  & \grambar &\valuedecl*{} \SEMI*{}\\
  & \grambar &\nodedecl*{} \SEMI*{}\\
  & \grambar &\graphdecl*{} \SEMI*{}
  \\& & \\

\gramfunc{\typedecl{}}& \gramdef & \TYPE*{} \IDENT*{}
  \\& & \\

\gramfunc{\valuedecl{}}& \gramdef & \VAL*{} \gramopt{\REC*{}} \netbinding*{}
  \\& & \\

\gramfunc{\nodedecl{}}& \gramdef & \nodeintf*{} \nodeimpl*{}
  \\& & \\

\gramfunc{\nodeintf{}}& \gramdef & \NODE*{} \IDENT*{}
                                    \gramopt{\nodeparams*{}} \IN*{}
                                    \iodecls*{} \OUT*{} \iodecls*{}
  \\& & \\

\gramfunc{\nodeimpl{}}& \gramdef & \grameps \\
  & \grambar &\ACTOR*{} \gramstar{\actordesc*{}} \zzzEND*{}\\
  & \grambar &\STRUCT*{} \structgraphdesc*{} \zzzEND*{}\\
  & \grambar &\FUN*{} \fungraphdesc*{} \zzzEND*{}
  \\& & \\

\gramfunc{\actordesc{}}& \gramdef & \IDENT*{} \LPAREN*{}
                                     \gramseplist{\COMMA*{}}{\implattr*{}}
                                     \RPAREN*{}
  \\& & \\

\gramfunc{\implattr{}}& \gramdef & \IDENT*{} \EQUAL*{} \STRING*{}\\
  & \grambar &\IDENT*{}
  \\& & \\

\gramfunc{\nodeparams{}}& \gramdef & \PARAM*{} \LPAREN*{}
                                      \gramseplist{\COMMA*{}}{\nodeparamdecl*{}}
                                      \RPAREN*{}
  \\& & \\

\gramfunc{\nodeparamdecl{}}& \gramdef & \IDENT*{} \COLON*{}
                                         \simpletypeexpr*{}
  \\& & \\

\gramfunc{\iodecls{}}& \gramdef & \LPAREN*{}
                                   \gramseplist{\COMMA*{}}{\iodecl*{}}
                                   \RPAREN*{}
  \\& & \\

\gramfunc{\iodecl{}}& \gramdef & \IDENT*{} \COLON*{} \simpletypeexpr*{}
                                  \optioannots*{}
  \\& & \\

\gramfunc{\optioannots{}}& \gramdef & \grameps \\
  & \grambar &\LBRACKET*{} \coreexpr*{} \RBRACKET*{}\\
  & \grambar &\LBRACE*{} \gramseplist{\COMMA*{}}{\ioannot*{}} \RBRACE*{}
  \\& & \\

\gramfunc{\ioannot{}}& \gramdef & \IDENT*{} \EQUAL*{} \STRING*{}
  \\& & \\

\gramfunc{\coreexpr{}}& \gramdef & \simplecoreexpr*{}\\
  & \grambar &\coreexpr*{} \INFIXIII*{} \coreexpr*{}\\
  & \grambar &\coreexpr*{} \INFIXII*{} \coreexpr*{}\\
  & \grambar &\coreexpr*{} \STAR*{} \coreexpr*{}
  \\& & \\

\gramfunc{\simplecoreexpr{}}& \gramdef & \IDENT*{}\\
  & \grambar &\INT*{}\\
  & \grambar &\TRUE*{}\\
  & \grambar &\FALSE*{}\\
  & \grambar &\LPAREN*{} \coreexpr*{} \RPAREN*{}
  \\& & \\

\gramfunc{\simpletypeexpr{}}& \gramdef & \IDENT*{}\\
  & \grambar &\TYINT*{}\\
  & \grambar &\TYBOOL*{}
  \\& & \\

\gramfunc{\graphdecl{}}& \gramdef & \GRAPH*{} \IDENT*{}
                                     \gramopt{\graphparams*{}} \IN*{}
                                     \iodecls*{} \OUT*{} \iodecls*{}
                                     \graphdefn*{}
  \\& & \\

\gramfunc{\graphparams{}}& \gramdef & \PARAM*{} \LPAREN*{}
                                       \gramseplist{\COMMA*{}}{\graphparamvalue*{}}
                                       \RPAREN*{}
  \\& & \\

\gramfunc{\graphparamvalue{}}& \gramdef & \IDENT*{} \COLON*{}
                                           \simpletypeexpr*{} \EQUAL*{}
                                           \constparamvalue*{}
  \\& & \\

\gramfunc{\constparamvalue{}}& \gramdef & \INT*{}\\
  & \grambar &\TRUE*{}\\
  & \grambar &\FALSE*{}
  \\& & \\

\gramfunc{\graphdefn{}}& \gramdef & \STRUCT*{} \structgraphdesc*{}
                                     \zzzEND*{}\\
  & \grambar &\FUN*{} \fungraphdesc*{} \zzzEND*{}
  \\& & \\

\gramfunc{\structgraphdesc{}}& \gramdef & \gramstar{\structdefn*{}}
  \\& & \\

\gramfunc{\structdefn{}}& \gramdef & \gwiredefn*{}\\
  & \grambar &\gnodedefn*{}
  \\& & \\

\gramfunc{\gwiredefn{}}& \gramdef & \WIRE*{}
                                     \gramseplist{\COMMA*{}}{\IDENT*{}}
                                     \COLON*{} \simpletypeexpr*{}
  \\& & \\

\gramfunc{\gnodedefn{}}& \gramdef & \NODE*{} \IDENT*{} \COLON*{} \IDENT*{}
                                     \gramopt{\gnodeparams*{}} \gnodeios*{}
                                     \gnodeios*{}
  \\& & \\

\gramfunc{\gnodeparams{}}& \gramdef & \LESS*{}
                                       \gramseplist{\COMMA*{}}{\coreexpr*{}}
                                       \GREATER*{}
  \\& & \\

\gramfunc{\gnodeios{}}& \gramdef & \LPAREN*{}
                                    \gramseplist{\COMMA*{}}{\gnodeio*{}}
                                    \RPAREN*{}
  \\& & \\

\gramfunc{\gnodeio{}}& \gramdef & \IDENT*{}
  \\& & \\

\gramfunc{\fungraphdesc{}}& \gramdef & \gramstar{\netdefn*{}}
  \\& & \\

\gramfunc{\netdefn{}}& \gramdef & \VAL*{} \gramopt{\REC*{}}
                                   \gramsepnelist{\AND*{}}{\netbinding*{}}
  \\& & \\

\gramfunc{\netbinding{}}& \gramdef & \netpattern*{} \EQUAL*{} \netexpr*{}\\
  & \grambar &\netbindingname*{} \gramplus{\simplenetpattern*{}} \EQUAL*{}
               \netexpr*{}
  \\& & \\

\gramfunc{\netbindingname{}}& \gramdef & \IDENT*{}\\
  & \grambar &\LPAREN*{} \INFIX*{} \RPAREN*{}
  \\& & \\

\gramfunc{\netexpr{}}& \gramdef & \simplenetexpr*{}\\
  & \grambar &\simplenetexpr*{} \gramplus{\simplenetexpr*{}}\\
  & \grambar &\netexprcommalist*{}\\
  & \grambar &\netexpr*{} \COLONCOLON*{} \netexpr*{}\\
  & \grambar &\simplenetexpr*{} \LBRACKET*{} \simplenetexpr*{} \RBRACKET*{}\\
  & \grambar &\LET*{} \gramopt{\REC*{}}
               \gramsepnelist{\AND*{}}{\netbinding*{}} \IN*{} \netexpr*{}\\
  & \grambar &\FUN*{} \netpattern*{} \ARROW*{} \netexpr*{}\\
  & \grambar &\MATCH*{} \netexpr*{} \WITH*{}
               \gramsepnelist{\BAR*{}}{\netcase*{}}\\
  & \grambar &\IF*{} \netexpr*{} \THEN*{} \netexpr*{} \ELSE*{} \netexpr*{}\\
  & \grambar &\netexpr*{} \INFIXIII*{} \netexpr*{}\\
  & \grambar &\netexpr*{} \INFIXII*{} \netexpr*{}\\
  & \grambar &\netexpr*{} \INFIX*{} \netexpr*{}\\
  & \grambar &\netexpr*{} \GREATER*{} \netexpr*{}\\
  & \grambar &\netexpr*{} \LESS*{} \netexpr*{}\\
  & \grambar &\netexpr*{} \STAR*{} \netexpr*{}\\
  & \grambar &\netexpr*{} \EQUAL*{} \netexpr*{}\\
  & \grambar &\netexpr*{} \NOTEQUAL*{} \netexpr*{}
  \\& & \\

\gramfunc{\simplenetexpr{}}& \gramdef & \IDENT*{}\\
  & \grambar &\IDENT*{} \LESS*{} \gramsepnelist{\COMMA*{}}{\coreexpr*{}}
               \GREATER*{}\\
  & \grambar &\LPAREN*{} \RPAREN*{}\\
  & \grambar &\LBRACKET*{} \netexprcommalist*{} \RBRACKET*{}\\
  & \grambar &\LBRACKET*{} \RBRACKET*{}\\
  & \grambar &\INT*{}\\
  & \grambar &\TRUE*{}\\
  & \grambar &\FALSE*{}\\
  & \grambar &\LPAREN*{} \netexpr*{} \RPAREN*{}
  \\& & \\

\gramfunc{\netexprcommalist{}}& \gramdef & \netexprcommalist*{} \COMMA*{}
                                            \netexpr*{}\\
  & \grambar &\netexpr*{} \COMMA*{} \netexpr*{}
  \\& & \\

\gramfunc{\netcase{}}& \gramdef & \netpattern*{} \ARROW*{} \netexpr*{}
  \\& & \\

\gramfunc{\netpattern{}}& \gramdef & \simplenetpattern*{}\\
  & \grambar &\netpatterncommalist*{}\\
  & \grambar &\netpattern*{} \COLONCOLON*{} \netpattern*{}\\
  & \grambar &\LBRACKET*{} \netpatterncommalist*{} \RBRACKET*{}
  \\& & \\

\gramfunc{\simplenetpattern{}}& \gramdef & \IDENT*{}\\
  & \grambar &\UNDERSCORE*{}\\
  & \grambar &\LPAREN*{} \netpattern*{} \RPAREN*{}\\
  & \grambar &\LBRACKET*{} \RBRACKET*{}\\
  & \grambar &\LPAREN*{} \RPAREN*{}
  \\& & \\

\gramfunc{\netpatterncommalist{}}& \gramdef & \netpatterncommalist*{}
                                               \COMMA*{} \netpattern*{}\\
  & \grambar &\netpattern*{} \COMMA*{} \netpattern*{}
  \\& & \\

\end{grammar}
