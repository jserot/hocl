Sequential version for testing functions
